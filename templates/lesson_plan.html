<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="/static/menu.js"></script>
    <link rel="stylesheet" href="/static/main.style.css">
    <link rel="stylesheet" href="/static/class.style.css">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"/>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"/>
</head>
<body>
<div id="menu_id" class="menu"></div>
<script> createMenu(document.getElementById('menu_id'));</script>
<div>
    <br><label for="listOfClasses_id">wybierz przedmiot</label><br/>
    <select id="listOfClasses_id" name="listOfClasses" onchange="sendNameClass()"></select>
</div>
<div class="flex-container" id="plannLessonId">
    <table id="table_id"></table>
</div>
</body>
<script>
    async function selectOfTeachers(select){
        const listOfTeacher =await(await fetch('/teacher/get_all_teacher')).json();
        for(const i of listOfTeacher){
            const option = document.createElement("option");
            option.innerHTML = `${i.name} ${i.last_name}`;
            option.value= i.id;
            select.appendChild(option);

        }
        return select

    }
    async function selOfSubjects(select) {
        const listOfSubject = await (await fetch('/subject/get_all')).json();
        for (const i of listOfSubject) {
            const option = document.createElement("option");
            option.innerHTML = i.name;
            select.appendChild(option);
        }
        return select;
    }
    async function getTable() {
        document.getElementById("table_id").innerHTML = '';
       // const selectOfTeacher = selectOfTeachers();

        //const listOfSubject= await(await fetch('/subject/get_all')).json();
        const hours = await (await fetch('/lessonPlan/getAllTime')).json();
        const tableOfLessonPlan = document.getElementById("table_id");
        const Hrow = tableOfLessonPlan.createTHead().insertRow();
        for (const i of ['godziny', 'poniedzialek', 'wtorek', 'sroda', 'czwartek', 'piatek', 'sobota', 'niedziela'])
            Hrow.insertCell().innerHTML = i;

        // let lp = 1
        //
        for (const j of hours) {
            //     const currentSubjects = (await getSubjectsOfTeacher(j.id)).map(obj => obj.subject);
            const row = tableOfLessonPlan.insertRow();
            row.insertCell().innerHTML = `${j.from_hour}-${j.until_hours}`;

            const selectTeachers = document.createElement("select");
            const selectSubject = document.createElement("select");
           await selectOfTeachers(selectTeachers);
           await selOfSubjects(selectSubject);
            row.insertCell().innerHTML = '';
            row.cells[1].appendChild(selectTeachers);
            row.cells[1].appendChild(selectSubject);
           // row.cells[1].appendChild(selectOfTeacher);
            // row.cells[1].appendChild(selectOfSubject)
        }
    }


        async function listOfClasses() {
            const name_classes = await (await fetch('/lessonPlan/get_all_names_class')).json();
            const select_name_classes = document.getElementById("listOfClasses_id");
            for (const i of name_classes) {
            const option = document.createElement("option");
            option.value = i['class.id'];
                option.innerHTML= i['name_class'];
                select_name_classes.appendChild(option);
            }



    }
    async function init(){
        await listOfClasses();
        await getTable();
    }
    init();

</script>
</html>